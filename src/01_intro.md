# 第1章: 電子書籍制作の全体像

電子書籍フォーマットには EPUB、PDF、かつて主流だった MOBI などがありますが、
**2025 年時点で Kindle も EPUB ネイティブ対応**となり、事実上 EPUB が標準です。

## 1.1 なぜ Pandoc なのか？

- **多フォーマット変換**：EPUB/PDF/HTML/DOCX を同時出力  
- **OSS エコシステム**：Lua フィルタやクロスリファレンスなど拡張が豊富  
- **CI/CD 連携**：GitHub Actions や GitLab CI で自動化しやすい  

## 1.2 EPUB フォーマットの特徴

EPUB は以下のような特徴を持つ電子書籍フォーマットです：

- **リフロー型レイアウト**：画面サイズに応じて自動的に改行が調整される
- **HTML5 + CSS3**：Web 技術をベースにした構造
- **メタデータ**：タイトル、著者、ISBN などの情報を XML で管理
- **目次**：NCX と HTML ナビゲーションの両方をサポート
- **DRM**：オプションでデジタル著作権管理が可能

### EPUB の内部構造

```
book.epub
├── mimetype
├── META-INF/
│   └── container.xml
├── OEBPS/
│   ├── content.opf
│   ├── toc.ncx
│   ├── nav.xhtml
│   ├── chapter1.xhtml
│   ├── chapter2.xhtml
│   └── styles/
│       └── style.css
└── images/
    └── cover.jpg
```

## 1.3 一般的な電子書籍制作フロー

従来の電子書籍制作フローには以下のような課題がありました：

1. **原稿作成**
   - Word や Google Docs で執筆
   - フォーマットの一貫性維持が困難
   - バージョン管理が面倒

2. **EPUB 変換**
   - 手動での HTML 変換
   - 目次の手動作成
   - メタデータの個別設定

3. **品質チェック**
   - 目視での確認
   - 複数デバイスでのテスト
   - エラーの手動修正

## 1.4 Pandoc による改善

Pandoc を導入することで、以下のような改善が期待できます：

### メリット

1. **効率化**
   - 1 コマンドでの EPUB 生成
   - 自動目次生成
   - バッチ処理による一括変換

2. **品質向上**
   - 一貫したフォーマット
   - 自動バリデーション
   - エラーの早期発見

3. **拡張性**
   - Lua フィルタによるカスタマイズ
   - テンプレートの再利用
   - プラグインによる機能追加

### デメリットと対策

1. **学習コスト**
   - 対策：段階的な学習と実践
   - 対策：サンプルコードの提供

2. **環境依存**
   - 対策：Docker による環境統一
   - 対策：CI/CD による自動化

## 1.5 本書で目指すワークフロー

本書では、以下のような理想的なワークフローを目指します：

1. **執筆環境**
   - Markdown での原稿作成
   - Git によるバージョン管理
   - エディタの自動補完

2. **ビルド環境**
   - Makefile による自動化
   - fswatch によるホットリロード
   - エラーチェックの自動化

3. **公開環境**
   - GitHub Actions による自動ビルド
   - リリースの自動化
   - プレビューの自動生成

## 1.6 演習問題

1. EPUB フォーマットの特徴を3つ挙げ、それぞれの利点を説明してください。
2. Pandoc を使用する利点を、従来のワークフローと比較して説明してください。
3. 理想的な電子書籍制作ワークフローを実現するために、どのようなツールや仕組みが必要か考えてください。

